var ToggleButtonComponent_1;
import { __decorate } from "tslib";
import { Component, Input, EventEmitter, Output, forwardRef, HostListener, ViewChild } from '@angular/core';
import { NG_VALUE_ACCESSOR, FormControl, FormBuilder } from '@angular/forms';
let ToggleButtonComponent = ToggleButtonComponent_1 = class ToggleButtonComponent {
    constructor() {
        this.disabled = false;
        this.checked = false;
        this.tabIndex = 0;
        this.updateEvent = new EventEmitter();
        this.primary = false;
        this.secondary = false;
        this.small = false;
        this.onChange = () => { };
        this.onTouched = () => { };
    }
    onKeydown(event) {
        const key = event.code || event.keyCode;
        switch (key) {
            case 'Enter':
            case 'NumpadEnter':
            case 13:
            case 'Space':
            case 32:
                if (!this.disabled) {
                    this.change();
                    this.form.controls[this.name].setValue(this.checked);
                    event.preventDefault();
                }
                break;
        }
    }
    writeValue(value) {
        this.checked = value;
    }
    registerOnChange(fn) {
        this.onChange = fn;
    }
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    ngOnInit() {
        this.generateIfNecessary();
        this.checkProperties();
    }
    ngOnChanges() {
        this.generateIfNecessary();
        this.checkProperties();
    }
    checkProperties() {
        if (this.toggleButton) {
            const properties = this.toggleButton.split(' ');
            if (properties.indexOf('primary') > -1) {
                this.primary = true;
            }
            else if (properties.indexOf('secondary') > -1) {
                this.secondary = true;
            }
            if (properties.indexOf('small') > -1) {
                this.small = true;
            }
        }
        if (this.iconLeft) {
            this.iconRight = undefined;
        }
        if (this.disabled) {
            this.form.controls[this.name].disable();
        }
        else {
            this.form.controls[this.name].enable();
        }
    }
    generateIfNecessary() {
        if (!this.id)
            this.id = Math.random()
                .toString(36)
                .substring(2);
        if (!this.name)
            this.name = 'toggle-button-' + this.id;
        if (!this.form) {
            const control = {};
            control[this.name] = new FormControl(this.checked);
            this.form = new FormBuilder().group(control);
        }
    }
    change() {
        this.checked = !this.checked;
        this.updateEvent.emit(this);
        this.onChange(this.checked);
        if (this.onTouched) {
            this.onTouched();
        }
    }
    focus() {
        this.buttonInput.nativeElement.focus();
    }
    stopPropagation(event) {
        event.stopPropagation();
    }
};
__decorate([
    ViewChild('buttonInput')
], ToggleButtonComponent.prototype, "buttonInput", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "name", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "iconRight", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "iconLeft", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "disabled", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "checked", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "toggleButton", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "form", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "id", void 0);
__decorate([
    Input()
], ToggleButtonComponent.prototype, "tabIndex", void 0);
__decorate([
    Output()
], ToggleButtonComponent.prototype, "updateEvent", void 0);
__decorate([
    HostListener('keydown', ['$event'])
], ToggleButtonComponent.prototype, "onKeydown", null);
ToggleButtonComponent = ToggleButtonComponent_1 = __decorate([
    Component({
        selector: 'bmw-toggle-button',
        template: "<div [class.disabled]=\"disabled\" [formGroup]=\"form\">\n  <input\n    #buttonInput\n    type=\"checkbox\"\n    [name]=\"name\"\n    [id]=\"id\"\n    [checked]=\"checked\"\n    [attr.aria-checked]=\"checked\"\n    (change)=\"change()\"\n    [formControlName]=\"name\"\n    [tabindex]=\"disabled ? -1 : tabIndex\"\n  />\n  <label\n    [class.icon-left]=\"iconLeft\"\n    [class.icon-right]=\"iconRight\"\n    [class.button--primary]=\"primary === true\"\n    [class.button--secondary]=\"secondary === true\"\n    [class.button--small]=\"small === true\"\n    [for]=\"id\"\n    (click)=\"stopPropagation($event)\"\n  >\n    <i\n      *ngIf=\"iconLeft\"\n      [ngClass]=\"[\n        iconLeft,\n        'icon-left',\n        small === true ? 'bmw-component-headline-text-small' : 'bmw-component-headline-text'\n      ]\"\n    ></i>\n    <div [ngClass]=\"small === true ? 'bmw-component-headline-text-small' : 'bmw-component-headline-text'\">\n      <ng-content></ng-content>\n    </div>\n    <i\n      *ngIf=\"iconRight\"\n      [ngClass]=\"[\n        iconRight,\n        'icon-right',\n        small === true ? 'bmw-component-headline-text-small' : 'bmw-component-headline-text'\n      ]\"\n    ></i>\n  </label>\n</div>\n",
        providers: [
            {
                provide: NG_VALUE_ACCESSOR,
                useExisting: forwardRef(() => ToggleButtonComponent_1),
                multi: true
            }
        ],
        styles: ["input{width:.1px;height:.1px;opacity:0;position:absolute;z-index:-1}:host{max-width:100%}div label{cursor:pointer;padding:var(--toggle-button__medium__padding);border:solid 1px var(--toggle-button__default__border__color);display:inline-block;box-sizing:border-box;text-align:center;vertical-align:middle;text-transform:uppercase;background-color:var(--toggle-button__default__background-color);position:relative;max-width:100%}div label.icon-left{padding-left:calc(var(--typography__component-headline-text__font-size) + var(--toggle-button__medium__padding) + var(--toggle-button__default__icon__padding))}div label.icon-right{padding-right:calc(var(--typography__component-headline-text__font-size) + var(--toggle-button__medium__padding) + var(--toggle-button__default__icon__padding))}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){div label{padding-top:calc(var(--toggle-button__medium__padding) + 2px);padding-bottom:calc(var(--toggle-button__medium__padding) - 2px)}div label.icon-left{padding-left:30px}div label.icon-right{padding-right:30px}}div label i{position:absolute}div label i.icon-left{left:var(--toggle-button__medium__padding)}div label i.icon-right{right:var(--toggle-button__medium__padding)}div label i.bmw-component-headline-text{height:var(--typography__component-headline-text__line-height);top:calc(50% - var(--typography__component-headline-text__line-height)/ 2);line-height:var(--typography__component-headline-text__line-height);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}div label i.bmw-component-headline-text-small{height:var(--typography__component-headline-text-small__line-height);top:calc(50% - var(--typography__component-headline-text-small__line-height)/ 2);line-height:var(--typography__component-headline-text-small__line-height)}div label.button--primary{border:solid 1px var(--toggle-button__primary__background-color);background-color:var(--toggle-button__primary__background-color)}div label.button--primary .bmw-component-headline-text,div label.button--primary .bmw-component-headline-text-small{color:var(--toggle-button__primary__color)}div label.button--secondary{border:solid 1px var(--toggle-button__secondary__border__color);background-color:var(--toggle-button__secondary__background-color)}div label:active{border:solid 1px var(--toggle-button__default__active__background-color);background-color:var(--toggle-button__default__active__background-color);color:var(--toggle-button__default__active__color)}div label:active.button--primary{background-color:var(--toggle-button__primary__active__background-color)}div label:active.button--primary .bmw-component-headline-text{color:var(--toggle-button__default__active__color)}div label:active.button--primary .bmw-component-headline-text-small{color:var(--toggle-button__default__active__color)}div label:active.button--secondary{background-color:var(--toggle-button__secondary__active__background-color)}div label:active.button--secondary .bmw-component-headline-text{color:var(--toggle-button__default__active__color)}div label:active.button--secondary .bmw-component-headline-text-small{color:var(--toggle-button__default__active__color)}div label:hover{border:solid 1px var(--toggle-button__default__border__color);background-color:var(--toggle-button__default__hover__background-color)}div label:hover .bmw-component-headline-text,div label:hover .bmw-component-headline-text-small{color:var(--toggle-button__default__hover__color)}div label:hover.button--primary{border:solid 1px var(--toggle-button__primary__hover__background-color);background-color:var(--toggle-button__primary__hover__background-color)}div label:hover.button--primary .bmw-component-headline-text{color:var(--toggle-button__primary__hover__color)}div label:hover.button--primary .bmw-component-headline-text-small{color:var(--toggle-button__primary__hover__color)}div label:hover.button--secondary{border:solid 1px var(--toggle-button__secondary__border__color)}div label:hover.button--secondary .bmw-component-headline-text{color:var(--toggle-button__secondary__hover__color)}div label:hover.button--secondary .bmw-component-headline-text-small{color:var(--toggle-button__secondary__hover__color)}div label.button--small{padding:var(--toggle-button__small__padding);padding-top:var(--toggle-button__small__padding-top);padding-bottom:var(--toggle-button__small__padding-bottom)}div label.button--small.icon-left{padding-left:calc(var(--typography__component-headline-text-small__font-size) + var(--toggle-button__small__padding) + var(--toggle-button__default__icon__padding))}div label.button--small.icon-right{padding-right:calc(var(--typography__component-headline-text-small__font-size) + var(--toggle-button__small__padding) + var(--toggle-button__default__icon__padding))}@media all and (-ms-high-contrast:none),(-ms-high-contrast:active){div label.button--small{padding-top:calc(var(--toggle-button__small__padding-top) + 2px);padding-bottom:calc(var(--toggle-button__small__padding-bottom) - 2px)}div label.button--small.icon-left{padding-left:30px}div label.button--small.icon-right{padding-right:30px}}div label.button--small i.icon-left{left:var(--toggle-button__small__padding)}div label.button--small i.icon-right{right:var(--toggle-button__small__padding)}div input[disabled]+label{opacity:.7;pointer-events:none}div input[aria-checked=true]+label{border:solid 1px var(--toggle-button__default__border__color);background-color:var(--toggle-button__default__selected__background-color);color:var(--toggle-button__default__selected__color)}div input[aria-checked=true]+label .bmw-component-headline-text,div input[aria-checked=true]+label .bmw-component-headline-text-small{color:var(--toggle-button__default__selected__color)}div input[aria-checked=true]+label.button--primary{color:var(--toggle-button__primary__selected__color);border:solid 1px var(--toggle-button__primary__selected__background-color);background-color:var(--toggle-button__primary__selected__background-color)}div input[aria-checked=true]+label.button--primary .bmw-component-headline-text,div input[aria-checked=true]+label.button--primary .bmw-component-headline-text-small{color:var(--toggle-button__primary__selected__color)}div input[aria-checked=true]+label.button--secondary{color:var(--toggle-button__secondary__selected__color);border:solid 1px var(--toggle-button__secondary__border__color);background-color:var(--toggle-button__secondary__selected__background-color)}div input[aria-checked=true]+label.button--secondary .bmw-component-headline-text,div input[aria-checked=true]+label.button--secondary .bmw-component-headline-text-small{color:var(--toggle-button__secondary__selected__color)}div input:focus+label{outline:solid 1px;outline-color:var(--color-bmw-highlight);outline-offset:-1px;z-index:calc(var(--toggle-button__default__z-index) + 1)}div input:focus+label.button--primary{outline:solid 1px;outline-color:var(--color-bmw-basic5);outline-offset:-3px}div.disabled{cursor:no-drop}.bmw-component-headline-text,.bmw-component-headline-text-small{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"]
    })
], ToggleButtonComponent);
export { ToggleButtonComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9nZ2xlLWJ1dHRvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AYm13LWRzL2NvbXBvbmVudHMvIiwic291cmNlcyI6WyJ0b2dnbGUtYnV0dG9uL3RvZ2dsZS1idXR0b24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxFQUNMLFNBQVMsRUFFVCxLQUFLLEVBRUwsWUFBWSxFQUNaLE1BQU0sRUFFTixVQUFVLEVBQ1YsWUFBWSxFQUNaLFNBQVMsRUFFVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQXdCLGlCQUFpQixFQUFhLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQWM5RyxJQUFhLHFCQUFxQiw2QkFBbEMsTUFBYSxxQkFBcUI7SUFnRGhDO1FBdENBLGFBQVEsR0FBRyxLQUFLLENBQUM7UUFFakIsWUFBTyxHQUFHLEtBQUssQ0FBQztRQVFoQixhQUFRLEdBQUcsQ0FBQyxDQUFDO1FBRWIsZ0JBQVcsR0FBRyxJQUFJLFlBQVksRUFBeUIsQ0FBQztRQUN4RCxZQUFPLEdBQUcsS0FBSyxDQUFDO1FBQ2hCLGNBQVMsR0FBRyxLQUFLLENBQUM7UUFDbEIsVUFBSyxHQUFHLEtBQUssQ0FBQztRQUVOLGFBQVEsR0FBeUIsR0FBRyxFQUFFLEdBQUUsQ0FBQyxDQUFDO1FBQzFDLGNBQVMsR0FBYyxHQUFHLEVBQUUsR0FBRSxDQUFDLENBQUM7SUFvQnpCLENBQUM7SUFqQmhCLFNBQVMsQ0FBQyxLQUFvQjtRQUM1QixNQUFNLEdBQUcsR0FBRyxLQUFLLENBQUMsSUFBSSxJQUFJLEtBQUssQ0FBQyxPQUFPLENBQUM7UUFDeEMsUUFBUSxHQUFHLEVBQUU7WUFDWCxLQUFLLE9BQU8sQ0FBQztZQUNiLEtBQUssYUFBYSxDQUFDO1lBQ25CLEtBQUssRUFBRSxDQUFDO1lBQ1IsS0FBSyxPQUFPLENBQUM7WUFDYixLQUFLLEVBQUU7Z0JBQ0wsSUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVB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QkFBcUIsQ0ErSGpDO1NBL0hZLHFCQUFxQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgT25Jbml0LFxuICBJbnB1dCxcbiAgRWxlbWVudFJlZixcbiAgRXZlbnRFbWl0dGVyLFxuICBPdXRwdXQsXG4gIE9uQ2hhbmdlcyxcbiAgZm9yd2FyZFJlZixcbiAgSG9zdExpc3RlbmVyLFxuICBWaWV3Q2hpbGQsXG4gIEhvc3RCaW5kaW5nXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SLCBGb3JtR3JvdXAsIEZvcm1Db250cm9sLCBGb3JtQnVpbGRlciB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYm13LXRvZ2dsZS1idXR0b24nLFxuICB0ZW1wbGF0ZVVybDogJy4vdG9nZ2xlLWJ1dHRvbi5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3RvZ2dsZS1idXR0b24uY29tcG9uZW50Lmxlc3MnXSxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBUb2dnbGVCdXR0b25Db21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWVcbiAgICB9XG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgVG9nZ2xlQnV0dG9uQ29tcG9uZW50IGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE9uSW5pdCwgT25DaGFuZ2VzIHtcbiAgQFZpZXdDaGlsZCgnYnV0dG9uSW5wdXQnKVxuICBidXR0b25JbnB1dDogRWxlbWVudFJlZjtcbiAgQElucHV0KClcbiAgbmFtZTogc3RyaW5nO1xuICBASW5wdXQoKVxuICBpY29uUmlnaHQ6IHN0cmluZztcbiAgQElucHV0KClcbiAgaWNvbkxlZnQ6IHN0cmluZztcbiAgQElucHV0KClcbiAgZGlzYWJsZWQgPSBmYWxzZTtcbiAgQElucHV0KClcbiAgY2hlY2tlZCA9IGZhbHNlO1xuICBASW5wdXQoKVxuICB0b2dnbGVCdXR0b246IHN0cmluZztcbiAgQElucHV0KClcbiAgZm9ybTogRm9ybUdyb3VwO1xuICBASW5wdXQoKVxuICBpZDogc3RyaW5nO1xuICBASW5wdXQoKVxuICB0YWJJbmRleCA9IDA7XG4gIEBPdXRwdXQoKVxuICB1cGRhdGVFdmVudCA9IG5ldyBFdmVudEVtaXR0ZXI8VG9nZ2xlQnV0dG9uQ29tcG9uZW50PigpO1xuICBwcmltYXJ5ID0gZmFsc2U7XG4gIHNlY29uZGFyeSA9IGZhbHNlO1xuICBzbWFsbCA9IGZhbHNlO1xuXG4gIHByaXZhdGUgb25DaGFuZ2U6ICh2YWx1ZTogYW55KSA9PiB2b2lkID0gKCkgPT4ge307XG4gIHByaXZhdGUgb25Ub3VjaGVkOiAoKSA9PiBhbnkgPSAoKSA9PiB7fTtcblxuICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSlcbiAgb25LZXlkb3duKGV2ZW50OiBLZXlib2FyZEV2ZW50KSB7XG4gICAgY29uc3Qga2V5ID0gZXZlbnQuY29kZSB8fCBldmVudC5rZXlDb2RlO1xuICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICBjYXNlICdFbnRlcic6XG4gICAgICBjYXNlICdOdW1wYWRFbnRlcic6XG4gICAgICBjYXNlIDEzOlxuICAgICAgY2FzZSAnU3BhY2UnOlxuICAgICAgY2FzZSAzMjpcbiAgICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICAgICAgdGhpcy5jaGFuZ2UoKTtcbiAgICAgICAgICB0aGlzLmZvcm0uY29udHJvbHNbdGhpcy5uYW1lXS5zZXRWYWx1ZSh0aGlzLmNoZWNrZWQpO1xuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgY29uc3RydWN0b3IoKSB7fVxuXG4gIHdyaXRlVmFsdWUodmFsdWU6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmNoZWNrZWQgPSB2YWx1ZTtcbiAgfVxuXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IChfOiBib29sZWFuKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5vbkNoYW5nZSA9IGZuO1xuICB9XG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMuZ2VuZXJhdGVJZk5lY2Vzc2FyeSgpO1xuICAgIHRoaXMuY2hlY2tQcm9wZXJ0aWVzKCk7XG4gIH1cblxuICBuZ09uQ2hhbmdlcygpIHtcbiAgICB0aGlzLmdlbmVyYXRlSWZOZWNlc3NhcnkoKTtcbiAgICB0aGlzLmNoZWNrUHJvcGVydGllcygpO1xuICB9XG5cbiAgY2hlY2tQcm9wZXJ0aWVzKCkge1xuICAgIGlmICh0aGlzLnRvZ2dsZUJ1dHRvbikge1xuICAgICAgY29uc3QgcHJvcGVydGllcyA9IHRoaXMudG9nZ2xlQnV0dG9uLnNwbGl0KCcgJyk7XG4gICAgICBpZiAocHJvcGVydGllcy5pbmRleE9mKCdwcmltYXJ5JykgPiAtMSkge1xuICAgICAgICB0aGlzLnByaW1hcnkgPSB0cnVlO1xuICAgICAgfSBlbHNlIGlmIChwcm9wZXJ0aWVzLmluZGV4T2YoJ3NlY29uZGFyeScpID4gLTEpIHtcbiAgICAgICAgdGhpcy5zZWNvbmRhcnkgPSB0cnVlO1xuICAgICAgfVxuICAgICAgaWYgKHByb3BlcnRpZXMuaW5kZXhPZignc21hbGwnKSA+IC0xKSB7XG4gICAgICAgIHRoaXMuc21hbGwgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmljb25MZWZ0KSB7XG4gICAgICB0aGlzLmljb25SaWdodCA9IHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgdGhpcy5mb3JtLmNvbnRyb2xzW3RoaXMubmFtZV0uZGlzYWJsZSgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmZvcm0uY29udHJvbHNbdGhpcy5uYW1lXS5lbmFibGUoKTtcbiAgICB9XG4gIH1cblxuICBnZW5lcmF0ZUlmTmVjZXNzYXJ5KCkge1xuICAgIGlmICghdGhpcy5pZClcbiAgICAgIHRoaXMuaWQgPSBNYXRoLnJhbmRvbSgpXG4gICAgICAgIC50b1N0cmluZygzNilcbiAgICAgICAgLnN1YnN0cmluZygyKTtcblxuICAgIGlmICghdGhpcy5uYW1lKSB0aGlzLm5hbWUgPSAndG9nZ2xlLWJ1dHRvbi0nICsgdGhpcy5pZDtcblxuICAgIGlmICghdGhpcy5mb3JtKSB7XG4gICAgICBjb25zdCBjb250cm9sID0ge307XG4gICAgICBjb250cm9sW3RoaXMubmFtZV0gPSBuZXcgRm9ybUNvbnRyb2wodGhpcy5jaGVja2VkKTtcbiAgICAgIHRoaXMuZm9ybSA9IG5ldyBGb3JtQnVpbGRlcigpLmdyb3VwKGNvbnRyb2wpO1xuICAgIH1cbiAgfVxuXG4gIGNoYW5nZSgpIHtcbiAgICB0aGlzLmNoZWNrZWQgPSAhdGhpcy5jaGVja2VkO1xuICAgIHRoaXMudXBkYXRlRXZlbnQuZW1pdCh0aGlzKTtcblxuICAgIHRoaXMub25DaGFuZ2UodGhpcy5jaGVja2VkKTtcbiAgICBpZiAodGhpcy5vblRvdWNoZWQpIHtcbiAgICAgIHRoaXMub25Ub3VjaGVkKCk7XG4gICAgfVxuICB9XG5cbiAgZm9jdXMoKSB7XG4gICAgdGhpcy5idXR0b25JbnB1dC5uYXRpdmVFbGVtZW50LmZvY3VzKCk7XG4gIH1cblxuICBzdG9wUHJvcGFnYXRpb24oZXZlbnQ6IE1vdXNlRXZlbnQpIHtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxufVxuIl19