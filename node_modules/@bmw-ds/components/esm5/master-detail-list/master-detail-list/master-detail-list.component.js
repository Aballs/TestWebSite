import { __decorate } from "tslib";
import { Component, ContentChildren, HostBinding, Input, ViewChild } from '@angular/core';
import { MasterDetailListRowComponent } from '../master-detail-list-row/master-detail-list-row.component';
import { MasterDetailListDetailComponent } from '../master-detail-list-detail/master-detail-list-detail.component';
var MasterDetailListComponent = /** @class */ (function () {
    function MasterDetailListComponent() {
        this._smallStyle = false;
    }
    Object.defineProperty(MasterDetailListComponent.prototype, "smallStyle", {
        get: function () {
            return this._smallStyle;
        },
        set: function (value) {
            if (this._smallStyle !== value) {
                this._smallStyle = value;
                this.updateScrollToSelected();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MasterDetailListComponent.prototype, "masterDetail", {
        get: function () {
            return this._hasDetailView || this._smallStyle;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MasterDetailListComponent.prototype, "hasDetailView", {
        set: function (value) {
            if (this._hasDetailView !== value) {
                this._hasDetailView = value;
                this.updateScrollToSelected();
            }
        },
        enumerable: true,
        configurable: true
    });
    MasterDetailListComponent.prototype.ngOnInit = function () {
        if (!this.id) {
            this.id = Math.random()
                .toString(36)
                .substring(2);
        }
    };
    MasterDetailListComponent.prototype.ngAfterViewInit = function () {
        var _this = this;
        // listen for changes of ListDetailCoponents in list's content
        this.listDetails.changes.subscribe({
            next: function (elements) {
                // if detail is available, set class to host to enable master-detail styling
                _this.hasDetailView = elements.length > 0;
            }
        });
        this.childItemsComponent.changes.subscribe({
            next: function (elements) {
                _this.childItemsComponent.forEach(function (element) {
                    element.updateEvent.subscribe(function () {
                        _this.selectOne(element);
                    });
                });
            }
        });
        setTimeout(function () { return (_this.hasDetailView = _this.listDetails.length > 0); });
        this.childItemsComponent.forEach(function (element) {
            element.updateEvent.subscribe(function () {
                _this.selectOne(element);
            });
        });
    };
    MasterDetailListComponent.prototype.selectOne = function (selectItem) {
        if (!this.childItemsComponent) {
            return;
        }
        this.childItemsComponent.forEach(function (element) {
            element.selected = element === selectItem;
        });
    };
    MasterDetailListComponent.prototype.ngOnDestroy = function () {
        if (this.childItemsComponent) {
            this.childItemsComponent.forEach(function (element) {
                element.updateEvent.unsubscribe();
            });
        }
    };
    MasterDetailListComponent.prototype.updateScrollToSelected = function () {
        var _a;
        var selected = (_a = this.childItemsComponent) === null || _a === void 0 ? void 0 : _a.find(function (element) { return element.selected; });
        if (selected) {
            setTimeout(function () {
                selected.updateScrollPosition();
            });
        }
    };
    __decorate([
        ViewChild('items')
    ], MasterDetailListComponent.prototype, "items", void 0);
    __decorate([
        HostBinding('attr.id'),
        Input()
    ], MasterDetailListComponent.prototype, "id", void 0);
    __decorate([
        ContentChildren(MasterDetailListRowComponent)
    ], MasterDetailListComponent.prototype, "childItemsComponent", void 0);
    __decorate([
        ContentChildren(MasterDetailListDetailComponent)
    ], MasterDetailListComponent.prototype, "listDetails", void 0);
    __decorate([
        Input()
    ], MasterDetailListComponent.prototype, "smallStyle", null);
    __decorate([
        HostBinding('class.master-detail')
    ], MasterDetailListComponent.prototype, "masterDetail", null);
    MasterDetailListComponent = __decorate([
        Component({
            selector: 'bmw-master-detail-list',
            template: "<div\n  class=\"items\"\n  #items\n>\n  <ng-content select=\"bmw-master-detail-list-row\"></ng-content>\n</div>\n<ng-content select=\"bmw-master-detail-list-detail\"></ng-content>\n",
            styles: [":host{position:relative;min-height:0;width:100%;max-height:100%;overflow:auto;display:inline-block;min-width:186px;max-width:100%}:host .items{display:table;table-layout:auto;width:100%;max-height:100%;overflow:auto}:host.master-detail{display:flex;flex-direction:row;width:auto}@media screen and (min-width:37.49rem){:host.master-detail .items{width:auto;display:flex;flex:0 0 auto;flex-direction:column;overflow-y:auto}}"]
        })
    ], MasterDetailListComponent);
    return MasterDetailListComponent;
}());
export { MasterDetailListComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFzdGVyLWRldGFpbC1saXN0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BibXctZHMvY29tcG9uZW50cy8iLCJzb3VyY2VzIjpbIm1hc3Rlci1kZXRhaWwtbGlzdC9tYXN0ZXItZGV0YWlsLWxpc3QvbWFzdGVyLWRldGFpbC1saXN0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUVMLFNBQVMsRUFDVCxlQUFlLEVBRWYsV0FBVyxFQUNYLEtBQUssRUFHTCxTQUFTLEVBRVYsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLDRCQUE0QixFQUFFLE1BQU0sNERBQTRELENBQUM7QUFDMUcsT0FBTyxFQUFFLCtCQUErQixFQUFFLE1BQU0sa0VBQWtFLENBQUM7QUFPbkg7SUFBQTtRQWNVLGdCQUFXLEdBQUcsS0FBSyxDQUFDO0lBc0Y5QixDQUFDO0lBcEZDLHNCQUFJLGlEQUFVO2FBQWQ7WUFDRSxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUM7UUFDMUIsQ0FBQzthQUVELFVBQWUsS0FBYztZQUMzQixJQUFJLElBQUksQ0FBQyxXQUFXLEtBQUssS0FBSyxFQUFFO2dCQUM5QixJQUFJLENBQUMsV0FBVyxHQUFHLEtBQUssQ0FBQztnQkFDekIsSUFBSSxDQUFDLHNCQUFzQixFQUFFLENBQUM7YUFDL0I7UUFDSCxDQUFDOzs7T0FQQTtJQVNtQyxzQkFBSSxtREFBWTthQUFoQjtZQUNsQyxPQUFPLElBQUksQ0FBQyxjQUFjLElBQUksSUFBSSxDQUFDLFdBQVcsQ0FBQztRQUNqRCxDQUFDOzs7T0FBQTtJQUVELHNCQUFJLG9EQUFhO2FBQWpCLFVBQWtCLEtBQWM7WUFDOUIsSUFBSSxJQUFJLENBQUMsY0FBYyxLQUFLLEtBQUssRUFBRTtnQkFDakMsSUFBSSxDQUFDLGNBQWMsR0FBRyxLQUFLLENBQUM7Z0JBQzVCLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxDQUFDO2FBQy9CO1FBQ0gsQ0FBQzs7O09BQUE7SUFH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U0FBUyxDQUFDO1lBQ1QsUUFBUSxFQUFFLHdCQUF3QjtZQUNsQyxpTUFBa0Q7O1NBRW5ELENBQUM7T0FDVyx5QkFBeUIsQ0FvR3JDO0lBQUQsZ0NBQUM7Q0FBQSxBQXBHRCxJQW9HQztTQXBHWSx5QkFBeUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBBZnRlclZpZXdJbml0LFxuICBDb21wb25lbnQsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgRWxlbWVudFJlZixcbiAgSG9zdEJpbmRpbmcsXG4gIElucHV0LFxuICBPbkRlc3Ryb3ksXG4gIFF1ZXJ5TGlzdCxcbiAgVmlld0NoaWxkLFxuICBPbkluaXRcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBNYXN0ZXJEZXRhaWxMaXN0Um93Q29tcG9uZW50IH0gZnJvbSAnLi4vbWFzdGVyLWRldGFpbC1saXN0LXJvdy9tYXN0ZXItZGV0YWlsLWxpc3Qtcm93LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBNYXN0ZXJEZXRhaWxMaXN0RGV0YWlsQ29tcG9uZW50IH0gZnJvbSAnLi4vbWFzdGVyLWRldGFpbC1saXN0LWRldGFpbC9tYXN0ZXItZGV0YWlsLWxpc3QtZGV0YWlsLmNvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Jtdy1tYXN0ZXItZGV0YWlsLWxpc3QnLFxuICB0ZW1wbGF0ZVVybDogJy4vbWFzdGVyLWRldGFpbC1saXN0LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vbWFzdGVyLWRldGFpbC1saXN0LmNvbXBvbmVudC5sZXNzJ11cbn0pXG5leHBvcnQgY2xhc3MgTWFzdGVyRGV0YWlsTGlzdENvbXBvbmVudCBpbXBsZW1lbnRzIE9uRGVzdHJveSwgT25Jbml0LCBBZnRlclZpZXdJbml0IHtcbiAgQFZpZXdDaGlsZCgnaXRlbXMnKVxuICBpdGVtczogRWxlbWVudFJlZjtcblxuICBASG9zdEJpbmRpbmcoJ2F0dHIuaWQnKVxuICBASW5wdXQoKVxuICBpZDogc3RyaW5nO1xuXG4gIEBDb250ZW50Q2hpbGRyZW4oTWFzdGVyRGV0YWlsTGlzdFJvd0NvbXBvbmVudClcbiAgY2hpbGRJdGVtc0NvbXBvbmVudDogUXVlcnlMaXN0PE1hc3RlckRldGFpbExpc3RSb3dDb21wb25lbnQ+O1xuXG4gIEBDb250ZW50Q2hpbGRyZW4oTWFzdGVyRGV0YWlsTGlzdERldGFpbENvbXBvbmVudClcbiAgbGlzdERldGFpbHM6IFF1ZXJ5TGlzdDxNYXN0ZXJEZXRhaWxMaXN0RGV0YWlsQ29tcG9uZW50PjtcblxuICBwcml2YXRlIF9zbWFsbFN0eWxlID0gZmFsc2U7XG4gIEBJbnB1dCgpXG4gIGdldCBzbWFsbFN0eWxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9zbWFsbFN0eWxlO1xuICB9XG5cbiAgc2V0IHNtYWxsU3R5bGUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICBpZiAodGhpcy5fc21hbGxTdHlsZSAhPT0gdmFsdWUpIHtcbiAgICAgIHRoaXMuX3NtYWxsU3R5bGUgPSB2YWx1ZTtcbiAgICAgIHRoaXMudXBkYXRlU2Nyb2xsVG9TZWxlY3RlZCgpO1xuICAgIH1cbiAgfVxuXG4gIEBIb3N0QmluZGluZygnY2xhc3MubWFzdGVyLWRldGFpbCcpIGdldCBtYXN0ZXJEZXRhaWwoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2hhc0RldGFpbFZpZXcgfHwgdGhpcy5fc21hbGxTdHlsZTtcbiAgfVxuXG4gIHNldCBoYXNEZXRhaWxWaWV3KHZhbHVlOiBib29sZWFuKSB7XG4gICAgaWYgKHRoaXMuX2hhc0RldGFpbFZpZXcgIT09IHZhbHVlKSB7XG4gICAgICB0aGlzLl9oYXNEZXRhaWxWaWV3ID0gdmFsdWU7XG4gICAgICB0aGlzLnVwZGF0ZVNjcm9sbFRvU2VsZWN0ZWQoKTtcbiAgICB9XG4gIH1cbiAgcHJpdmF0ZSBfaGFzRGV0YWlsVmlldztcblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuaWQpIHtcbiAgICAgIHRoaXMuaWQgPSBNYXRoLnJhbmRvbSgpXG4gICAgICAgIC50b1N0cmluZygzNilcbiAgICAgICAgLnN1YnN0cmluZygyKTtcbiAgICB9XG4gIH1cblxuICBuZ0FmdGVyVmlld0luaXQoKSB7XG4gICAgLy8gbGlzdGVuIGZvciBjaGFuZ2VzIG9mIExpc3REZXRhaWxDb3BvbmVudHMgaW4gbGlzdCdzIGNvbnRlbnRcbiAgICB0aGlzLmxpc3REZXRhaWxzLmNoYW5nZXMuc3Vic2NyaWJlKHtcbiAgICAgIG5leHQ6IGVsZW1lbnRzID0+IHtcbiAgICAgICAgLy8gaWYgZGV0YWlsIGlzIGF2YWlsYWJsZSwgc2V0IGNsYXNzIHRvIGhvc3QgdG8gZW5hYmxlIG1hc3Rlci1kZXRhaWwgc3R5bGluZ1xuICAgICAgICB0aGlzLmhhc0RldGFpbFZpZXcgPSBlbGVtZW50cy5sZW5ndGggPiAwO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgdGhpcy5jaGlsZEl0ZW1zQ29tcG9uZW50LmNoYW5nZXMuc3Vic2NyaWJlKHtcbiAgICAgIG5leHQ6IGVsZW1lbnRzID0+IHtcbiAgICAgICAgdGhpcy5jaGlsZEl0ZW1zQ29tcG9uZW50LmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgZWxlbWVudC51cGRhdGVFdmVudC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3RPbmUoZWxlbWVudCk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgc2V0VGltZW91dCgoKSA9PiAodGhpcy5oYXNEZXRhaWxWaWV3ID0gdGhpcy5saXN0RGV0YWlscy5sZW5ndGggPiAwKSk7XG5cbiAgICB0aGlzLmNoaWxkSXRlbXNDb21wb25lbnQuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgIGVsZW1lbnQudXBkYXRlRXZlbnQuc3Vic2NyaWJlKCgpID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3RPbmUoZWxlbWVudCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHNlbGVjdE9uZShzZWxlY3RJdGVtOiBNYXN0ZXJEZXRhaWxMaXN0Um93Q29tcG9uZW50KSB7XG4gICAgaWYgKCF0aGlzLmNoaWxkSXRlbXNDb21wb25lbnQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5jaGlsZEl0ZW1zQ29tcG9uZW50LmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICBlbGVtZW50LnNlbGVjdGVkID0gZWxlbWVudCA9PT0gc2VsZWN0SXRlbTtcbiAgICB9KTtcbiAgfVxuXG4gIG5nT25EZXN0cm95KCkge1xuICAgIGlmICh0aGlzLmNoaWxkSXRlbXNDb21wb25lbnQpIHtcbiAgICAgIHRoaXMuY2hpbGRJdGVtc0NvbXBvbmVudC5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICBlbGVtZW50LnVwZGF0ZUV2ZW50LnVuc3Vic2NyaWJlKCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHVwZGF0ZVNjcm9sbFRvU2VsZWN0ZWQoKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLmNoaWxkSXRlbXNDb21wb25lbnQ/LmZpbmQoZWxlbWVudCA9PiBlbGVtZW50LnNlbGVjdGVkKTtcbiAgICBpZiAoc2VsZWN0ZWQpIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBzZWxlY3RlZC51cGRhdGVTY3JvbGxQb3NpdGlvbigpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59XG4iXX0=